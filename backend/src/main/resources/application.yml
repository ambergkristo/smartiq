spring:
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/smartiq}
    username: ${SPRING_DATASOURCE_USERNAME:smartiq}
    password: ${SPRING_DATASOURCE_PASSWORD:}
  jpa:
    hibernate:
      ddl-auto: validate
    open-in-view: false
  flyway:
    enabled: true
  h2:
    console:
      enabled: true

management:
  prometheus:
    metrics:
      export:
        enabled: true
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: never

smartiq:
  import:
    enabled: ${SMARTIQ_IMPORT_ENABLED:true}
    path: ${SMARTIQ_IMPORT_PATH:../data/clean}
  pool:
    enabled: ${SMARTIQ_POOL_ENABLED:true}
    minimum-per-key: ${MIN_BANK_SIZE:1000}
    low-watermark-per-key: ${POOL_LOW_WATERMARK:800}
    refill-target-per-key: ${POOL_TARGET:1200}
  session:
    enabled: ${SMARTIQ_SESSION_DEDUP_ENABLED:true}
    ttl-minutes: ${SMARTIQ_SESSION_TTL_MINUTES:120}
    max-sessions: ${SMARTIQ_SESSION_MAX:50000}
  bank:
    min-size: ${MIN_BANK_SIZE:1000}
    block-on-low-bank: ${SMARTIQ_BLOCK_ON_LOW_BANK:false}
    trigger-pipeline-on-low-bank: ${SMARTIQ_TRIGGER_PIPELINE_ON_LOW_BANK:false}
    pipeline-command: ${SMARTIQ_PIPELINE_COMMAND:npm run pipeline:cards}
  cors:
    allowed-origins:
      - ${SMARTIQ_CORS_ALLOWED_ORIGIN_LOCAL:http://localhost:5173}
      - ${SMARTIQ_CORS_ALLOWED_ORIGIN_PUBLIC:https://smartiq.vercel.app}
